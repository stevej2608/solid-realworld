import{s as K,W as z,c as P,o as X,a as B,u as x,b as M,d as L,e as Y,f as Z,g as ee,h as te,i as y,j as Q,k as re,l as H,t as v,m as d,n as V,S as R,p as T,q as _,r as oe,v as se,M as A,w as q,x as ne}from"./vendor-26062862.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))o(r);new MutationObserver(r=>{for(const a of r)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&o(i)}).observe(document,{childList:!0,subtree:!0});function t(r){const a={};return r.integrity&&(a.integrity=r.integrity),r.referrerPolicy&&(a.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?a.credentials="include":r.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function o(r){if(r.ep)return;r.ep=!0;const a=t(r);fetch(r.href,a)}})();const ae="modulepreload",ie=function(n){return"/"+n},I={},S=function(e,t,o){if(!t||t.length===0)return e();const r=document.getElementsByTagName("link");return Promise.all(t.map(a=>{if(a=ie(a),a in I)return;I[a]=!0;const i=a.endsWith(".css"),m=i?'[rel="stylesheet"]':"";if(!!o)for(let l=r.length-1;l>=0;l--){const s=r[l];if(s.href===a&&(!i||s.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${a}"]${m}`))return;const f=document.createElement("link");if(f.rel=i?"stylesheet":ae,i||(f.as="script",f.crossOrigin=""),f.href=a,document.head.appendChild(f),i)return new Promise((l,s)=>{f.addEventListener("load",l),f.addEventListener("error",()=>s(new Error(`Unable to preload CSS for ${a}`)))})})).then(()=>e())},ce=()=>new K({format:"{{index}} {{timestamp}} {{title}} {{message}}{{rhs}}{{file}}:{{line}}",dateformat:"HH:MM:ss",level:z.INFO}),le=()=>({info:()=>{},warn:()=>{},setLevel:()=>{}}),ue=()=>window.name!=="JSDOM",h=ue()?ce():le();function de(n){const[e,t]=P(window.location.hash.slice(2)||n),[o,r]=P(),[,a]=M(),i=()=>a(()=>{const c=window.location.hash.slice(2);h.info(">>>>>>>>>>>>>>>>>> setLocation(%s)",c),t(c)});let m;return window.addEventListener("hashchange",i),X(()=>window.removeEventListener("hashchange",i)),{location:e,setLocation:c=>{window.location.hash=`#/${c}`},match:(c,f)=>{const l=decodeURIComponent(e().split("?")[0]),s=f.exec(l);return s&&(m={params:s.slice(1),routeName:c},r()),!!s},getParams:()=>(o(),m)}}const G=B();function O(){return x(G)}class fe{baseUrl="/api";securityData=null;securityWorker;abortControllers=new Map;customFetch=(...e)=>(h.info("Fetch url=%s",e[0]),fetch(...e));baseApiParams={credentials:"same-origin",headers:{},redirect:"follow",referrerPolicy:"no-referrer"};constructor(e={}){Object.assign(this,e)}setSecurityData=e=>{this.securityData=e};encodeQueryParam(e,t){return`${encodeURIComponent(e)}=${encodeURIComponent(typeof t=="number"?t:`${t}`)}`}addQueryParam(e,t){return this.encodeQueryParam(t,e[t])}addArrayQueryParam(e,t){return e[t].map(r=>this.encodeQueryParam(t,r)).join("&")}toQueryString(e){const t=e||{};return Object.keys(t).filter(r=>typeof t[r]<"u").map(r=>Array.isArray(t[r])?this.addArrayQueryParam(t,r):this.addQueryParam(t,r)).join("&")}addQueryParams(e){const t=this.toQueryString(e);return t?`?${t}`:""}contentFormatters={["application/json"]:e=>e!==null&&(typeof e=="object"||typeof e=="string")?JSON.stringify(e):e,["text/plain"]:e=>e!==null&&typeof e!="string"?JSON.stringify(e):e,["multipart/form-data"]:e=>Object.keys(e||{}).reduce((t,o)=>{const r=e[o];return t.append(o,r instanceof Blob?r:typeof r=="object"&&r!==null?JSON.stringify(r):`${r}`),t},new FormData),["application/x-www-form-urlencoded"]:e=>this.toQueryString(e)};mergeRequestParams(e,t){return{...this.baseApiParams,...e,...t||{},headers:{...this.baseApiParams.headers||{},...e.headers||{},...t&&t.headers||{}}}}createAbortSignal=e=>{if(this.abortControllers.has(e)){const o=this.abortControllers.get(e);return o?o.signal:void 0}const t=new AbortController;return this.abortControllers.set(e,t),t.signal};abortRequest=e=>{const t=this.abortControllers.get(e);t&&(t.abort(),this.abortControllers.delete(e))};request=async({body:e,secure:t,path:o,type:r,query:a,format:i,baseUrl:m,cancelToken:c,...f})=>{const l=(typeof t=="boolean"?t:this.baseApiParams.secure)&&this.securityWorker&&await this.securityWorker(this.securityData)||{},s=this.mergeRequestParams(f,l),u=a&&this.toQueryString(a),g=this.contentFormatters[r||"application/json"],w=i||s.format;return this.customFetch(`${m||this.baseUrl||""}${o}${u?`?${u}`:""}`,{...s,headers:{...s.headers||{},...r&&r!=="multipart/form-data"?{"Content-Type":r}:{}},signal:c?this.createAbortSignal(c):s.signal,body:typeof e>"u"||e===null?null:g(e)}).then(async b=>{const p=b;p.data=null,p.error=null;const U=w?await b[w]().then(C=>(p.ok?p.data=C:p.error=C,p)).catch(C=>(p.error=C,p)):p;if(c&&this.abortControllers.delete(c),!b.ok)throw U;return U})}}/**
 * @title Conduit API
 * @version 1.0.0
 * @license MIT License (https://opensource.org/licenses/MIT)
 * @baseUrl /api
 * @contact RealWorld (https://realworld.io)
 *
 * Conduit API
 */class me extends fe{users={login:(e,t={})=>this.request({path:"/users/login",method:"POST",body:e,type:"application/json",format:"json",...t}),createUser:(e,t={})=>this.request({path:"/users",method:"POST",body:e,type:"application/json",format:"json",...t})};user={getCurrentUser:(e={})=>this.request({path:"/user",method:"GET",secure:!0,format:"json",...e}),updateCurrentUser:(e,t={})=>this.request({path:"/user",method:"PUT",body:e,secure:!0,type:"application/json",format:"json",...t})};profiles={getProfileByUsername:(e,t={})=>this.request({path:`/profiles/${e}`,method:"GET",format:"json",...t}),followUserByUsername:(e,t={})=>this.request({path:`/profiles/${e}/follow`,method:"POST",secure:!0,format:"json",...t}),unfollowUserByUsername:(e,t={})=>this.request({path:`/profiles/${e}/follow`,method:"DELETE",secure:!0,format:"json",...t})};articles={getArticlesFeed:(e,t={})=>this.request({path:"/articles/feed",method:"GET",query:e,secure:!0,format:"json",...t}),getArticles:(e,t={})=>this.request({path:"/articles",method:"GET",query:e,format:"json",...t}),createArticle:(e,t={})=>this.request({path:"/articles",method:"POST",body:e,secure:!0,type:"application/json",format:"json",...t}),getArticle:(e,t={})=>this.request({path:`/articles/${e}`,method:"GET",format:"json",...t}),updateArticle:(e,t,o={})=>this.request({path:`/articles/${e}`,method:"PUT",body:t,secure:!0,type:"application/json",format:"json",...o}),deleteArticle:(e,t={})=>this.request({path:`/articles/${e}`,method:"DELETE",secure:!0,...t}),getArticleComments:(e,t={})=>this.request({path:`/articles/${e}/comments`,method:"GET",format:"json",...t}),createArticleComment:(e,t,o={})=>this.request({path:`/articles/${e}/comments`,method:"POST",body:t,secure:!0,type:"application/json",format:"json",...o}),deleteArticleComment:(e,t,o={})=>this.request({path:`/articles/${e}/comments/${t}`,method:"DELETE",secure:!0,...o}),createArticleFavorite:(e,t={})=>this.request({path:`/articles/${e}/favorite`,method:"POST",secure:!0,format:"json",...t}),deleteArticleFavorite:(e,t={})=>this.request({path:`/articles/${e}/favorite`,method:"DELETE",secure:!0,format:"json",...t})};tags={tagsList:(e={})=>this.request({path:"/tags",method:"GET",format:"json",...e})}}const he="https://api.realworld.io/api",ge=n=>n.token?{Authorization:`Token ${n.token}`}:{};class pe extends me{constructor(e){super({baseUrl:he,baseApiParams:{headers:ge(e)}})}}const k=10;function ye(n,e,t,o){const r=async s=>{const u={offset:t.page*k,limit:k};return s.myFeed?(h.info("getArticlesFeed args=%s",JSON.stringify(u)),await n.articles.getArticlesFeed(u)):(s.favoritedBy&&(u.favorited=s.favoritedBy),s.tag&&(u.tag=s.tag),s.author&&(u.author=s.author),h.info("getArticles args=%s",JSON.stringify(u)),await n.articles.getArticles(u))},a=async(s,{value:u})=>{if(s[0]==="articles"){const{data:p,error:U}=await r(s[1]);if(h.info("Done"),U)throw U;const{articles:C,articlesCount:W}=p;queueMicrotask(()=>{o({totalPagesCount:Math.ceil(W/k)})});const F={};for(const N of C)F[N.slug]=N;return F}const g=s[1];if(g in t.articles)return u;const{data:w,error:b}=await n.articles.getArticle(g);if(b)throw b;return{...u,[g]:w.article}},[i,m]=P(),[c]=L(i,a,{initialValue:{}}),f=s=>{o("articles",s,u=>({favorited:!0,favoritesCount:u.favoritesCount+1}))},l=s=>{o("articles",s,u=>({favorited:!1,favoritesCount:u.favoritesCount-1}))};return Object.assign(e,{setPage:s=>{h.info("setPage(%d)",s),o({page:s})},loadArticles(s){m(["articles",s])},loadArticle(s){m(["article",s])},async makeFavorite(s){const u=t.articles[s];if(u&&!u.favorited){f(s);const{data:g,error:w}=await n.articles.createArticleFavorite(s);if(w)throw l(s),w}},async unmakeFavorite(s){const u=t.articles[s];if(u&&u.favorited){l(s);const{data:g,error:w}=await n.articles.deleteArticleFavorite(s);if(w)throw f(s),err}},async createArticle(s){const{data:u,error:g}=await n.articles.createArticle({article:s});if(g)throw g;return o("articles",{[u.article.slug]:u.article}),u.article},async updateArticle(s){const{data:u}=await n.articles.updateArticle(s.slug,{article:s});return o("articles",{[u.article.slug]:u.article}),u.article},async deleteArticle(s){const u=t.articles[s];o("articles",{[s]:void 0});try{await n.articles.deleteArticle(s)}catch(g){throw o("articles",{[s]:u}),g}}}),c}function we(n,e,t){const o=async()=>{const{data:c,error:f}=await n.user.getCurrentUser();return c.user},[r,a]=P(!1),[i,{mutate:m}]=L(r,o);return Object.assign(e,{pullUser:()=>a(!0),async login(c,f){const{data:l,error:s}=await n.users.login({user:{email:c,password:f}});if(s)throw s;e.setToken(l.user.token),a(!0)},async register(c,f,l){const{data:s,error:u}=await n.users.createUser({user:{username:c,email:f,password:l}});if(u)throw u;e.setToken(s.user.token),a(!0)},logout(){Y(()=>{e.setToken(void 0),m(void 0)})},async updateUser(c){const{data:f,error:l}=await n.user.updateCurrentUser({user:c});if(l)throw errors;m(f.user)}}),i}function ve(n,e,t){Z(()=>{e.token?(h.warn("Add token [%s ...]",e.token.slice(0,15)),localStorage.setItem("jwt",e.token)):(h.warn("Remove token"),localStorage.removeItem("jwt"))}),n.setToken=o=>{h.info("setToken tok=%s",o),t({token:o})}}function Ae(n){const e=async()=>{h.info("getTags");const{data:o,error:r}=await n.tags.tagsList();return o.tags.map(a=>a.toLowerCase())},[t]=L({initialValue:[]},e);return t}function $e(n,e,t,o){const[r,a]=P(),i=async()=>{const l=r();h.info("getArticleComments articleSlug = %s ...",l?l.slice(0,15):"undefined");const{data:s,error:u}=await n.articles.getArticleComments(l);return s.comments},[m,{mutate:c,refetch:f}]=L(r,i,{initialValue:[]});return Object.assign(e,{loadComments(l,s){if(s)return f();h.info("loadComments articleSlug=%s ...",l.slice(0,15)),a(l),o({articleSlug:l})},async createComment(l){await n.articles.createArticleComment(t.articleSlug,{comment:l})},async deleteComment(l){c(m().filter(s=>s.id!==l));try{await n.articles.deleteArticleComment(t.articleSlug,l)}catch(s){throw e.loadComments(t.articleSlug),s}}}),m}function Pe(n,e,t,o){const r=async c=>{const{data:f,error:l}=await n.profiles.getProfileByUsername(c);return f.profile},[a,i]=P(),[m]=L(a,r);return Object.assign(e,{loadProfile(c){i(c)},async follow(){if(t.profile&&!t.profile.following){o("profile","following",!0);try{await n.profiles.followUserByUsername(t.profile.username)}catch{o("profile","following",!1)}}},async unfollow(){if(t.profile&&t.profile.following){o("profile","following",!1);try{await n.profiles.unfollowUserByUsername(t.profile.username)}catch{o("profile","following",!0)}}}}),m}function be(){let n,e,t,o,r;const[a,i]=ee({get articles(){return n()},get comments(){return e()},get tags(){return t()},get profile(){return o()},get currentUser(){return r()},page:0,articleSlug:void 0,totalPagesCount:0,token:localStorage.getItem("jwt"),appName:"conduit"}),m={},c=new pe(a);return n=ye(c,m,a,i),e=$e(c,m,a,i),t=Ae(c),o=Pe(c,m,a,i),r=we(c,m),ve(m,a,i),[a,m]}const J=B();function E(){return x(J)}const Ce=v("<a>"),$=n=>{const{getParams:e}=O();return(()=>{const t=Ce();return t.$$click=()=>window.scrollTo(0,0),y(t,()=>n.children),Q(o=>{const r=n.class,a=!!(n.active||e()?.routeName===n.route),i=`#/${n.href||n.route}`;return r!==o._v$&&re(t,o._v$=r),a!==o._v$2&&t.classList.toggle("active",o._v$2=a),i!==o._v$3&&H(t,"href",o._v$3=i),o},{_v$:void 0,_v$2:void 0,_v$3:void 0}),t})()};te(["click"]);const _e=v('<i class="ion-compose">'),j=v('<li class="nav-item">'),Se=v('<i class="ion-gear-a">'),Ee=v('<img class="user-pic">'),Ue=v('<nav class="navbar navbar-light"><div class="container"><ul class="nav navbar-nav pull-xs-right"><li class="nav-item">'),je=()=>{const[n]=E();return(()=>{const e=Ue(),t=e.firstChild,o=t.firstChild,r=o.firstChild;return y(t,d($,{class:"navbar-brand",route:"",get children(){return n.appName}}),o),y(r,d($,{class:"nav-link",route:"",children:"Home"})),y(o,d(R,{get when(){return n.currentUser},get fallback(){return[(()=>{const a=j();return y(a,d($,{class:"nav-link",route:"login",children:"Sign in"})),a})(),(()=>{const a=j();return y(a,d($,{class:"nav-link",route:"register",children:"Sign up"})),a})()]},get children(){return[(()=>{const a=j();return y(a,d($,{class:"nav-link",route:"editor",get children(){return[_e()," New Post"]}})),a})(),(()=>{const a=j();return y(a,d($,{class:"nav-link",route:"settings",get children(){return[Se()," Settings"]}})),a})(),(()=>{const a=j();return y(a,d($,{class:"nav-link",route:"profile",get href(){return`@${n.currentUser.username}`},get children(){return[(()=>{const i=Ee();return Q(()=>H(i,"src",n.currentUser.image)),i})(),V(()=>n.currentUser.username)]}})),a})()]}}),null),e})()},Le=_(()=>S(()=>import("./Home-f4dab788.js"),["assets/Home-f4dab788.js","assets/vendor-26062862.js","assets/ArticleList-c76d7d36.js","assets/FavoriteButton-fcc2b50e.js"]));function Te(){const[n,{loadArticles:e,setPage:t}]=E(),{token:o,appName:r}=n,{location:a}=O(),i=V(()=>{let l=o?"feed":"all";const s=a().split("?")[1];if(s){const g=new URLSearchParams(s).get("tab");g&&(l=g)}return t(0),h.info("feedTab changed to [%s]",l),l});h.info("tab %s",i());const[,m]=M(),c=()=>{switch(i()){case"feed":return{myFeed:!0};case"all":return{};case void 0:return;default:return{tag:i()}}},f=l=>{m(()=>{t(l),e(c())})};return T(()=>e(c())),Le({handleSetPage:f,appName:r,tab:i,state:n})}const Oe=_(()=>S(()=>import("./Article-9fcc597d.js"),["assets/Article-9fcc597d.js","assets/vendor-26062862.js","assets/ListErrors-0bcc1fdc.js","assets/FavoriteButton-fcc2b50e.js","assets/FollowingButton-ddd8bec3.js"]));function qe(n){const[e,{loadArticle:t,loadComments:o}]=E(),r=n.params[0];return h.info("************** page=Article] ******************"),r in e.articles||t(r),o(r),d(R,{get when(){return e.articles[r]},get children(){return d(Oe,{slug:r})}})}const ke=_(()=>S(()=>import("./Profile-40c976f1.js"),["assets/Profile-40c976f1.js","assets/vendor-26062862.js","assets/ArticleList-c76d7d36.js","assets/FavoriteButton-fcc2b50e.js","assets/FollowingButton-ddd8bec3.js"]));function Re(n){const[,{loadProfile:e,loadArticles:t}]=E(),{location:o}=O(),r=n.params[0];return T(()=>n.routeName==="profile"&&e(r)),T(()=>{n.routeName==="profile"&&o().includes("/favorites")?t({favoritedBy:r}):t({author:r})}),d(ke,{get username(){return n.params[0]}})}const Fe=_(()=>S(()=>import("./Editor-dab0a93b.js"),["assets/Editor-dab0a93b.js","assets/vendor-26062862.js","assets/ListErrors-0bcc1fdc.js"]));function Ne(n){const[e,{loadArticle:t}]=E(),o=n.params[0];return h.info("***** Editor[slug=%s] **********",o),o&&t(o),Fe({slug:o})}const Ie=v('<div data-testid="container">'),De=v('<div class="container loader">'),Be=_(()=>S(()=>import("./Settings-66c003aa.js"),["assets/Settings-66c003aa.js","assets/vendor-26062862.js","assets/ListErrors-0bcc1fdc.js"])),D=_(()=>S(()=>import("./Auth-b33eef55.js"),["assets/Auth-b33eef55.js","assets/vendor-26062862.js","assets/ListErrors-0bcc1fdc.js"])),xe=()=>{const[n,{pullUser:e}]=E(),[t,o]=P(!1),{match:r,getParams:a}=O();return h.info("Starting %s",99),n.token?(e(),T(()=>n.currentUser&&o(!0))):o(!0),(()=>{const i=Ie();return y(i,d(je,{}),null),y(i,d(R,{get when(){return t()},get fallback(){return De()},get children(){return d(oe,{get children(){return d(se,{get children(){return[d(A,{get when(){return r("editor",/^editor\/?(.*)/)},get children(){return d(Ne,q(a))}}),d(A,{get when(){return r("settings",/^settings/)},get children(){return d(Be,{})}}),d(A,{get when(){return r("login",/^login/)},get children(){return d(D,{})}}),d(A,{get when(){return r("register",/^register/)},get children(){return d(D,{})}}),d(A,{get when(){return r("article",/^article\/(.*)/)},get children(){return d(qe,q(a))}}),d(A,{get when(){return r("profile",/^@([^/]*)\/?(favorites)?/)},get children(){return d(Re,q(a))}}),d(A,{get when(){return r("",/^#?$/)},get children(){return d(Te,{})}})]}})}})}}),null),i})()};function Me(n){const e=de(""),t=be();return d(G.Provider,{value:e,get children(){return d(J.Provider,{value:t,get children(){return n.children}})}})}const Qe=()=>d(Me,{get children(){return d(xe,{})}});ne(()=>Qe(),document.body);export{$ as N,O as a,h as l,E as u};
//# sourceMappingURL=index-004e05de.js.map
