import{i as t,m as l,l as y,h as H,t as d,g as Q,j as x,F as V,r as X,p as Y,z as Z,y as ee,S as P,A as te,B as re}from"./vendor-26062862.js";import{N as p,u as D,a as le}from"./index-004e05de.js";import{L as ne}from"./ListErrors-0bcc1fdc.js";import{F as I}from"./FavoriteButton-fcc2b50e.js";import{F as N}from"./FollowingButton-ddd8bec3.js";const ie=d('<img class="comment-author-img" alt="">'),se=d('<div class="card"><div class="card-block"><p class="card-text"></p></div><div class="card-footer">&nbsp;<span class="date-posted">'),ae=d('<span class="mod-options"><i class="ion-trash-a">'),oe=({comment:a,currentUser:e,onDelete:c})=>{const m=e&&e.username===a.author.username,{id:o,body:i,author:{username:u,image:f},createdAt:s}=a;return(()=>{const r=se(),$=r.firstChild,b=$.firstChild,_=$.nextSibling,h=_.firstChild,v=h.nextSibling;return b.textContent=i,t(_,l(p,{href:`@${u}`,route:"profile",class:"comment-author",get children(){const n=ie();return y(n,"src",f),n}}),h),t(_,l(p,{href:`@${u}`,route:"profile",class:"comment-author",children:u}),v),t(v,()=>new Date(s).toDateString()),t(_,m&&(()=>{const n=ae(),g=n.firstChild;return g.$$click=c,g.$$clickData=o,n})(),null),r})()};H(["click"]);const ce=d('<form class="card comment-form"><div class="card-block"><textarea class="form-control" placeholder="Write a comment..." rows="3"></textarea></div><div class="card-footer"><img class="comment-author-img" alt=""><button class="btn btn-sm btn-primary" type="submit">Post Comment'),de=({slug:a,createComment:e,loadComments:c,currentUser:m})=>{const[o,i]=Q({body:""}),u=s=>i({body:s.target.value}),f=s=>{s.preventDefault(),i({isCreatingComment:!0}),e({body:o.body}).then(()=>{i({body:""}),c(a,!0)}).catch(r=>i({errors:r})).finally(()=>i({isCreatingComment:!1}))};return[l(ne,{get errors(){return o.errors}}),(()=>{const s=ce(),r=s.firstChild,$=r.firstChild,b=r.nextSibling,_=b.firstChild;return s.addEventListener("submit",f),$.addEventListener("change",u),x(h=>{const v=o.isCreatingComment,n=m.image;return v!==h._v$&&($.disabled=h._v$=v),n!==h._v$2&&y(_,"src",h._v$2=n),h},{_v$:void 0,_v$2:void 0}),x(()=>$.value=o.body),s})()]},ue=d('<div class="col-xs-12 col-md-8 offset-md-2">'),me=d("<p>&nbsp;or&nbsp;<!>&nbsp;to add comments on this article."),fe=()=>{const[a,{createComment:e,deleteComment:c,loadComments:m}]=D(),{currentUser:o,articleSlug:i}=a,u=f=>{c(f)};return(()=>{const f=ue();return t(f,o?l(de,{slug:i,currentUser:o,createComment:e,loadComments:m}):(()=>{const s=me(),r=s.firstChild,$=r.nextSibling;return $.nextSibling,t(s,l(p,{route:"login",children:"Sign in"}),r),t(s,l(p,{route:"register",children:"sign up"}),$),s})(),null),t(f,l(X,{fallback:"Loading comments",get children(){return l(V,{get each(){return a.comments},children:s=>l(oe,{comment:s,currentUser:o,onDelete:u})})}}),null),f})()},$e=d('<img alt="">'),he=d('<i class="ion-edit">'),ge=d('<span><button class="btn btn-outline-danger btn-sm"><i class="ion-trash-a"></i> Delete Article'),_e=d('<div class="article-meta"><div class="info"><span class="date">'),z=d("<span>"),ve=d('<div class="article-page"><div class="banner"><div class="container"><h1></h1></div></div><div class="container page"><div class="row article-content"><div class="col-xs-12"><div></div><ul class="tag-list"></ul></div></div><hr><div class="article-actions"><div class="article-meta"><a href=""><img></a><div class="info"><a href="" class="author"></a><span class="date"></span></div>&nbsp;</div></div><div class="row">'),Ce=d('<li class="tag-default tag-pill tag-outline">'),pe=a=>{const[e]=Z(a,["article","profile"]);return D(),(()=>{const c=_e(),m=c.firstChild,o=m.firstChild;return t(c,l(p,{get href(){return`@${e.article?.author.username}`},route:"profile",get children(){const i=$e();return x(()=>y(i,"src",e.article.author.image)),i}}),m),t(m,l(p,{get href(){return`@${e.article.author.username}`},route:"profile",class:"author",get children(){return e.article?.author.username}}),o),t(o,()=>new Date(e.article.createdAt).toDateString()),t(c,l(P,{get when(){return a.canModify},get fallback(){return z()},get children(){const i=ge(),u=i.firstChild;return t(i,l(p,{get href(){return`editor/${e.article.slug}`},route:"editor",class:"btn btn-outline-secondary btn-sm",get children(){return[he()," Edit Article"]}}),u),ee(u,"click",a.onDelete,!0),i}}),null),t(c,l(P,{get when(){return!a.canModify},get fallback(){return z()},get children(){return[l(N,{get profile(){return e.profile},get onClick(){return a.onClickFollow}}),"Â ",l(I,{get article(){return e.article},title:"Favorite Article",get onClick(){return a.onClickFavorite}})]}}),null),c})()},we=({slug:a})=>{const[e,{deleteArticle:c,unmakeFavorite:m,makeFavorite:o,loadProfile:i,unfollow:u,follow:f}]=D(),{setLocation:s}=le(),r=e.articles[a],$=()=>e.currentUser&&e.currentUser.username===r.author.username,b=async()=>{await c(a),location.hash="/"};Y(()=>i(r.author.username));const _=n=>{if(n){const g=te(n?.body,{mangle:!1,headerIds:!1});return re.sanitize(g)}return""},h=(n,g)=>{if(g.preventDefault(),e.token){const k=n.slug;n.favorited?m(k):o(k)}else s("login")},v=n=>{n.preventDefault(),e.profile.following?u():f()};return(()=>{const n=ve(),g=n.firstChild,k=g.firstChild,R=k.firstChild,j=g.nextSibling,F=j.firstChild,T=F.firstChild,A=T.firstChild,W=A.nextSibling,q=F.nextSibling,L=q.nextSibling,w=L.firstChild,E=w.firstChild,G=E.firstChild,M=E.nextSibling,B=M.firstChild,J=B.nextSibling,K=M.nextSibling,O=L.nextSibling;return t(R,()=>r?.title),t(k,l(pe,{article:r,get profile(){return e.profile},get canModify(){return $()},onClickFavorite:h,onClickFollow:v,onDelete:b}),null),t(W,()=>r.tagList.map(C=>(()=>{const S=Ce();return t(S,C),S})())),t(B,()=>r.author.username),J.textContent=new Date(r.createdAt).toDateString(),t(w,l(N,{get profile(){return e.profile},onClick:v}),K),t(w,l(I,{article:r,title:"Favorite Article",onClick:h}),null),t(O,l(fe,{})),x(C=>{const S=_(r),U=r.author.image;return S!==C._v$&&(A.innerHTML=C._v$=S),U!==C._v$2&&y(G,"src",C._v$2=U),C},{_v$:void 0,_v$2:void 0}),n})()};H(["click"]);export{we as default};
//# sourceMappingURL=Article-9fcc597d.js.map
